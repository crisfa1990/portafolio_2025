<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Cheatsheet Pandas - Excel y CSV 游늵</title>
    
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Font Awesome para 칤conos -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet">
    
    <!-- Google Fonts: Roboto -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500&display=swap" rel="stylesheet">
    
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            font-size: 11px;
            background: #fff;
            padding: 10px 10px 10px 20px;
        }
        h1 {
            font-weight: 500;
            margin-bottom: 20px;
            font-size: 1.5rem;
        }
        pre {
            background: #f8f9fa;
            padding: 6px;
            border-radius: 4px;
            font-size: 11px;
            word-wrap: break-word;
            margin-bottom: 8px;
        }
        h2 {
            border-bottom: 1px solid #dee2e6;
            padding-bottom: 2px;
            margin-top: 15px;
            color: #0d6efd;
            font-size: 1.1rem;
        }
        h3 {
            font-size: 1rem;
            color: #495057;
            margin-top: 10px;
        }
        .bi, .fa {
            color: #0d6efd;
            margin-right: 3px;
            font-size: 0.9rem;
        }
        .section-title {
            display: flex;
            align-items: center;
        }
        .section-title i {
            margin-right: 5px;
        }
        .col-md-6 {
            padding: 0 5px;
        }
        @media print {
            body {
                padding: 0 0 0 20px;
                margin: 0;
            }
            .container {
                max-width: 100%;
                padding: 0;
            }
            pre {
                page-break-inside: avoid;
            }
        }
    </style>
</head>
<body class="container my-2">

    <h1 class="text-center">游늵 Cheatsheet Pandas - Excel y CSV</h1>

    <div class="row">
        <div class="col-md-6">
            <h2 class="section-title"><i class="fa fa-file-excel"></i> Manejo de Archivos Excel</h2>
            
            <h3>Lectura B치sica</h3>
            <pre># Leer archivo Excel
df = pd.read_excel('archivo.xlsx')

# Leer hoja espec칤fica
df = pd.read_excel('archivo.xlsx', sheet_name='Hoja1')

# Leer m칰ltiples hojas
dfs = pd.read_excel('archivo.xlsx', sheet_name=['Hoja1', 'Hoja2'])

# Leer rango espec칤fico
df = pd.read_excel('archivo.xlsx', usecols='A:C')
df = pd.read_excel('archivo.xlsx', nrows=100)</pre>

            <h3>Opciones Avanzadas de Lectura</h3>
            <pre># Especificar encabezados
df = pd.read_excel('archivo.xlsx', 
    header=0,  # Primera fila como encabezado
    names=['col1', 'col2', 'col3']  # Nombres personalizados
)

# Manejo de valores nulos
df = pd.read_excel('archivo.xlsx',
    na_values=['NA', 'N/A', '#N/A'],
    keep_default_na=True
)

# Especificar tipos de datos
dtype = {
    'col1': 'int64',
    'col2': 'float64',
    'col3': 'str'
}
df = pd.read_excel('archivo.xlsx', dtype=dtype)</pre>

            <h3>Escritura de Excel</h3>
            <pre># Guardar DataFrame en Excel
df.to_excel('salida.xlsx')

# Especificar hoja
df.to_excel('salida.xlsx', sheet_name='Datos')

# Sin 칤ndice
df.to_excel('salida.xlsx', index=False)

# M칰ltiples hojas
with pd.ExcelWriter('salida.xlsx') as writer:
    df1.to_excel(writer, sheet_name='Hoja1')
    df2.to_excel(writer, sheet_name='Hoja2')</pre>
        </div>

        <div class="col-md-6">
            <h2 class="section-title"><i class="fa fa-file-csv"></i> Manejo de Archivos CSV</h2>
            
            <h3>Lectura B치sica</h3>
            <pre># Leer archivo CSV
df = pd.read_csv('archivo.csv')

# Especificar separador
df = pd.read_csv('archivo.csv', sep=',')

# Especificar encoding
df = pd.read_csv('archivo.csv', encoding='utf-8')

# Leer desde URL
df = pd.read_csv('https://ejemplo.com/datos.csv')</pre>

            <h3>Opciones Avanzadas de Lectura</h3>
            <pre># Manejo de encabezados
df = pd.read_csv('archivo.csv',
    header=0,  # Primera fila como encabezado
    names=['col1', 'col2', 'col3']  # Nombres personalizados
)

# Manejo de valores nulos
df = pd.read_csv('archivo.csv',
    na_values=['NA', 'N/A', '#N/A'],
    keep_default_na=True
)

# Especificar tipos de datos
dtype = {
    'col1': 'int64',
    'col2': 'float64',
    'col3': 'str'
}
df = pd.read_csv('archivo.csv', dtype=dtype)</pre>

            <h3>Escritura de CSV</h3>
            <pre># Guardar DataFrame en CSV
df.to_csv('salida.csv')

# Sin 칤ndice
df.to_csv('salida.csv', index=False)

# Especificar separador
df.to_csv('salida.csv', sep=';')

# Especificar encoding
df.to_csv('salida.csv', encoding='utf-8')

# Especificar columnas
df.to_csv('salida.csv', columns=['col1', 'col2'])</pre>
        </div>
    </div>

    <div class="row">
        <div class="col-md-6">
            <h2 class="section-title"><i class="fa fa-cogs"></i> Procesamiento de Datos</h2>
            
            <h3>Limpieza de Datos</h3>
            <pre># Eliminar filas con valores nulos
df.dropna()

# Rellenar valores nulos
df.fillna(0)
df.fillna(method='ffill')  # Forward fill
df.fillna(method='bfill')  # Backward fill

# Eliminar duplicados
df.drop_duplicates()

# Eliminar columnas
df.drop(['col1', 'col2'], axis=1)</pre>

            <h3>Transformaci칩n de Datos</h3>
            <pre># Cambiar tipos de datos
df['columna'] = df['columna'].astype('int64')
df['fecha'] = pd.to_datetime(df['fecha'])

# Aplicar funciones
df['columna'] = df['columna'].apply(lambda x: x * 2)

# Reemplazar valores
df.replace({'S칤': True, 'No': False})

# Crear nuevas columnas
df['nueva_col'] = df['col1'] + df['col2']</pre>
        </div>

        <div class="col-md-6">
            <h2 class="section-title"><i class="fa fa-chart-line"></i> An치lisis de Datos</h2>
            
            <h3>Estad칤sticas B치sicas</h3>
            <pre># Estad칤sticas descriptivas
df.describe()

# Conteo de valores
df['columna'].value_counts()

# Agrupaci칩n
df.groupby('columna').mean()
df.groupby(['col1', 'col2']).sum()

# Pivot tables
pd.pivot_table(df, values='valor',
    index='fila', columns='columna')</pre>

            <h3>Filtrado y Selecci칩n</h3>
            <pre># Filtrado b치sico
df[df['edad'] > 30]
df[(df['edad'] > 30) & (df['ciudad'] == 'Madrid')]

# Selecci칩n de columnas
df[['col1', 'col2']]

# Selecci칩n por posici칩n
df.iloc[0:5]  # Primeras 5 filas
df.iloc[:, 0:3]  # Primeras 3 columnas

# Selecci칩n por etiqueta
df.loc[df['edad'] > 30]</pre>
        </div>
    </div>

    <div class="row">
        <div class="col-md-6">
            <h2 class="section-title"><i class="fa fa-tasks"></i> Optimizaci칩n</h2>
            
            <h3>Manejo de Memoria</h3>
            <pre># Optimizar tipos de datos
df['columna'] = df['columna'].astype('category')
df['columna'] = df['columna'].astype('int8')

# Ver uso de memoria
df.memory_usage(deep=True)
df.info(memory_usage='deep')</pre>

            <h3>Lectura Eficiente</h3>
            <pre># Leer por chunks
chunksize = 10000
for chunk in pd.read_csv('archivo.csv', chunksize=chunksize):
    procesar_chunk(chunk)

# Especificar tipos de datos al leer
dtype = {
    'col1': 'int8',
    'col2': 'float32',
    'col3': 'category'
}
df = pd.read_csv('archivo.csv', dtype=dtype)</pre>
        </div>

        <div class="col-md-6">
            <h2 class="section-title"><i class="fa fa-exclamation-triangle"></i> Soluci칩n de Problemas</h2>
            
            <h3>Errores Comunes</h3>
            <pre># Encoding incorrecto
df = pd.read_csv('archivo.csv', encoding='latin1')

# Separador incorrecto
df = pd.read_csv('archivo.csv', sep=';')

# Valores nulos inesperados
df = pd.read_csv('archivo.csv', na_values=['NA', 'N/A', '#N/A'])

# Tipos de datos incorrectos
df = pd.read_csv('archivo.csv', dtype={'columna': 'str'})</pre>

            <h3>Depuraci칩n</h3>
            <pre># Ver primeros registros
df.head()
df.head(10)

# Ver 칰ltimos registros
df.tail()
df.tail(10)

# Ver informaci칩n del DataFrame
df.info()
df.describe()

# Ver valores 칰nicos
df['columna'].unique()
df['columna'].value_counts()</pre>
        </div>
    </div>

</body>
</html> 